<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>learningdiary - 5&nbsp; Week4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./week3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week4.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Week4</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">learningdiary</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Week1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Week2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Week4</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#week-4-policy" id="toc-week-4-policy" class="nav-link active" data-scroll-target="#week-4-policy"><span class="header-section-number">5.1</span> Week 4: Policy</a>
  <ul class="collapse">
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">5.1.1</span> Summary:</a></li>
  <li><a href="#applications" id="toc-applications" class="nav-link" data-scroll-target="#applications"><span class="header-section-number">5.1.2</span> Applications:</a></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection"><span class="header-section-number">5.1.3</span> Reflection:</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">5.1.4</span> References:</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Week4</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="week-4-policy" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="week-4-policy"><span class="header-section-number">5.1</span> Week 4: Policy</h2>
<section id="summary" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">5.1.1</span> Summary:</h3>
<p>The city I chose is the capital of Indonesia, Jakarta. Jakarta is one of the most densely populated cities in the world. The city is facing many challenges, including rapid urbanization, traffic congestion, air pollution, land subsidence due to falling water tables (25cm per year), and severe flood risk. These The problem not only threatens the sustainable development of cities, but also affects the quality of life of residents.</p>
<p>Among them, the most serious problem is subsidence caused by rising sea levels, Jakarta is located on the northwest coast of Java, Indonesia. Parts of the city are built on swampland. This geological structure itself is relatively prone to subsidence. In addition, rising sea levels caused by global warming have exacerbated Jakarta’s subsidence problem, especially in coastal areas, which face greater risks of flooding. Some human factors also lead to ground subsidence. First, huge amounts of underground water pumping, primarily for residential, commercial and industrial water use, became an uncontrolled activity (Colven, 2020). Second, rapid urban expansion and large-scale construction projects have increased ground pressure, especially in swamps and soft soil. Third, the system has insufficient drainage, such as frequent rainfall that prevents ground moisture from draining away.</p>
<p>More details are in the video below.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Z9cJQN6lw3w" frameborder="0" allowfullscreen="">
</iframe>
<p>In order to solve the subsidence problem in Jakarta, the Indonesian government and local agencies are taking a series of measures: Restrict groundwater extraction: Adopt laws and policies to limit illegal groundwater extraction and promote the use of alternative water sources, such as surface water and recycled water. Build seawalls and locks: Build large-scale seawall and lock projects to control seawater intrusion and mitigate the effects of flooding. Improve urban drainage systems: Improve and expand urban drainage systems to increase their ability to handle rainfall and flooding. Sustainable urban planning: Promote green building and sustainable urban planning concepts to reduce negative impacts on the environment and address the challenges posed by land subsidence.</p>
<p>Some predictions indicate that Jakarta will completely sink by 2050. Therefore, the government and relevant departments should continue to speed up the pace and actively respond. The next section: “Application” will talk about the specific application of remote sensing technology in sea level rise and ground subsidence.</p>
</section>
<section id="applications" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="applications"><span class="header-section-number">5.1.2</span> Applications:</h3>
<p>In the case of Indonesia, especially Jakarta, remote sensing technologies (including InSAR and GNSS) are often used to help study land subsidence problems in low-lying coastal areas (Andreas et al., 2020), through geological surveys (such as leveling, global Navigation Satellite System (GNSS) and Synthetic Aperture Radar Interferometry (InSAR)), which can identify annual subsidence rates. The authors analyze time series of remote sensing data such as Google Earth or Landsat image archives, combined with land subsidence measurements and groundwater monitoring point data, as well as the mentioned statistical data to identify land subsidence areas, coastal land subsidence affected areas, potential seawater intrusion and aquifers method of damage.</p>
<p>Remote sensing technology plays an important role in helping to deal with land subsidence. It can provide effective detection and analysis of all aspects. First, synthetic aperture radar (SAR) technology can provide high-resolution surface deformation images to help identify and monitor ground subsidence areas. Interferometric Synthetic Aperture Radar (InSAR) is a remote sensing technology used to monitor surface deformation. It can accurately detect small changes in the surface such as land subsidence, landslides and post-earthquake deformation. InSAR technology analyzes tiny deformations on the ground through images acquired by synthetic aperture radar (SAR). InSAR data allows for time series analysis, which has become an important tool for detecting, measuring, and analyzing displacements on the Earth’s surface (Osmanoğlu et al., 2016). In addition, SAR measurements include both amplitude and phase observations. Amplitude refers to the intensity of backscattered electromagnetic waves, which is related to the shape, direction and electrical characteristics of the target. The phase reflects the change of the wave, but it is difficult to accurately obtain the total number of distance or wavelength. By comparing the phase changes in the two SAR measurements, we can detect the small changes that occurred between the two imaging times. This method is called InSAR (Osmanoğlu et al., 2016). The following figure illustrates the basic observable phase of a typical InSAR measurement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/w4-InSAR.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="figures/w4-InSAR.png" class="img-fluid" width="446"></p>
</div>
</div>
<p>figure1: Schematic explaining repeated pass interferometry (Osmanoğlu et al., 2016)</p>
<p>In this study, Osmanoğlu et al.&nbsp;(2016) used InSAR data time series analysis to compare the performance of four different algorithms (PSI, SBAS, SqueeSAR, StaMPS) in dealing with land subsidence monitoring in Mexico City. The study found that despite the high ground subsidence rate in Mexico City, the four algorithms all obtained similar settlement rates and deformation patterns, but the StaMPS method gave a lower settlement rate. In addition, the theory of combining time series analysis with phase unwrapping can provide potential technical and computational advantages for analyzing InSAR observations in three dimensions (two space and one time).</p>
<p>According to Ma et al.&nbsp;(2019) for the study of land subsidence in the Guangdong-Hong Kong-Macao Greater Bay Area (GBA) in China, we can determine that single-sensor synthetic aperture radar (SAR) images have a smaller coverage area and lower resolution, due to Sediments in the GBA are widely distributed, so SAR is not suitable for complete monitoring of the GBA. Therefore, in their study, the authors used the MT-InSAR method, using a combination of Sentinel-1 (S1), COSMO-SkyMed (CSK), and TerraSAR-X (TSX) images to reveal the multiscale subsidence of the GBA. Recognizing the advantages of MT-InSAR, several studies have applied it to monitor subsidence-prone bay/delta regions around the world.</p>
<p>The first article mainly discusses the application of time series analysis of InSAR data in monitoring and measuring earth surface deformation. The article discusses the need for phase unwrapping to obtain meaningful results due to the large surface variability, and mentions several different algorithms developed for this purpose. Although these algorithms are based on different models, they can all produce first-order deformation rates and can be compared with each other. The article proposes that no single algorithm can provide optimal results in all situations, as each algorithm has its own unique advantages and disadvantages, and is discussed in the paper through measurements of sinking rates in Mexico City. The second article focuses on the multi-scale subsidence problem in the Guangdong-Hong Kong-Macau Greater Bay Area (GBA) and analyzes the main causes of subsidence in the region. This article uses Sentinel-1 (S1), COSMO-SkyMed (CSK) and TerraSAR-X (TSX) images, and uses a variety of SAR images to reveal the multi-scale subsidence phenomenon in the GBA area. In addition, the article specifically mentions two local subsidence cases and emphasizes that CSK data is superior to S1 data in some aspects, such as point density, height accuracy and fewer false alarms. Finally, the article summarizes the practicality of using multi-sensor SAR images for regional surveys and fine monitoring of local areas.</p>
<p>In summary, the second article focuses more on the methods and algorithms of InSAR data analysis, while the third one focuses more on the surface subsidence problem in a specific area (i.e.&nbsp;GBA), and uses multi-sensor SAR images for monitoring. Both articles discuss the application of InSAR technology in ground monitoring, but the focus and geographical scope are different.</p>
</section>
<section id="reflection" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="reflection"><span class="header-section-number">5.1.3</span> Reflection:</h3>
<p>Studying policy issues in Jakarta in this module introduced me to the many ways in which remote sensing data can be used to address urban environmental issues such as land subsidence. Exploring remote sensing technologies such as InSAR and GNSS through Jakarta’s land subsidence problem highlights the key role of technological advancement in environmental monitoring and urban planning. Gaining a deeper understanding of how these technologies can provide high-resolution images and data to effectively detect and analyze ground deformation has not only enhanced my understanding of land subsidence monitoring, but also expanded my knowledge of the application of these technologies in a broader context. Through detailed case studies comparing Mexico City and China’s Guangdong-Hong Kong-Macau Greater Bay Area, I learned how different InSAR data analysis algorithms and methods can be leveraged to address specific geographic and situational needs. The importance of choosing appropriate algorithms is a valuable lesson for any policy or environmental analysis. Furthermore, it is predicted that Jakarta may be completely submerged by 2050 if drastic measures are not taken, reminding us of the urgency needed when addressing environmental issues. This prompts us to consider the wider implications of urban policy and planning, the key importance of sustainable practices, and the delicate balance that must be struck between development and conservation.</p>
</section>
<section id="references" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="references"><span class="header-section-number">5.1.4</span> References:</h3>
<p>Andreas, H., Abidin, H.Z., Sarsito, D.A. and Pradipta, D. (2020). Remotes sensing capabilities on land subsidence and coastal water hazard and disaster studies. IOP Conference Series: Earth and Environmental Science, 500(1), p.012036. doi:<a href="https://doi.org/10.1088/1755-1315/500/1/012036." class="uri">https://doi.org/10.1088/1755-1315/500/1/012036.</a></p>
<p>Colven, E. (2020). Subterranean infrastructures in a sinking city: the politics of visibility in Jakarta. <em>Critical Asian Studies</em>, 52(3), pp.311–331. doi:https://doi.org/10.1080/14672715.2020.1793210.</p>
<p>Ma, P., Wang, W., Zhang, B., Wang, J., Shi, G., Huang, G., Chen, F., Jiang, L. and Lin, H. (2019). Remotely sensing large- and small-scale ground subsidence: A case study of the Guangdong–Hong Kong–Macao Greater Bay Area of China. Remote Sensing of Environment, 232, p.111282. doi:<a href="https://doi.org/10.1016/j.rse.2019.111282." class="uri">https://doi.org/10.1016/j.rse.2019.111282.</a></p>
<p>Osmanoğlu, B., Sunar, F., Wdowinski, S. and Cabral-Cano, E. (2016). Time series analysis of InSAR data: Methods and trends. <em>ISPRS Journal of Photogrammetry and Remote Sensing</em>, 115, pp.90–102. doi:https://doi.org/10.1016/j.isprsjprs.2015.10.003.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week3.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week3</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>